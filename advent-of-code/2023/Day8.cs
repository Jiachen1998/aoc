namespace aoc._2023
{
    internal static class Day8
    {
        private static readonly string TestInput = "RL\r\n\r\nAAA = (BBB, CCC)\r\nBBB = (DDD, EEE)\r\nCCC = (ZZZ, GGG)\r\nDDD = (DDD, DDD)\r\nEEE = (EEE, EEE)\r\nGGG = (GGG, GGG)\r\nZZZ = (ZZZ, ZZZ)";
        private static readonly string TestInput2 = "LLR\r\n\r\nAAA = (BBB, BBB)\r\nBBB = (AAA, ZZZ)\r\nZZZ = (ZZZ, ZZZ)";
        private static readonly string TestInput3 = "LR\r\n\r\n11A = (11B, XXX)\r\n11B = (XXX, 11Z)\r\n11Z = (11B, XXX)\r\n22A = (22B, XXX)\r\n22B = (22C, 22C)\r\n22C = (22Z, 22Z)\r\n22Z = (22B, 22B)\r\nXXX = (XXX, XXX)";
        private static readonly string Input = "LLRLRRLLRLRRLLRLRRLRRRLRLRLRRRLLRLRRRLRLRRRLRLRLLLRRLRLRLLRLRRLRRRLRRRLLRRLRLRRRLRRLRRRLRLLRRLRRRLRRRLRRLRLRRLLLRLRLLRRRLRRLLRLRLRRLLRLRRLLRLRRLRRLLRRRLRLRLRRRLLRRRLRRLRRRLRRRLRLRRRLRRLLLRRRLRLLLRRRLRLLRLLRRRLLRRLRRRLRRRLRLLRLRLRRRLLRRLRRRLRRLRLLRRRLRRLRRRLRRRLRRRLRLRRRLRRRLRLRRRR\r\n\r\nXGS = (FDM, XCS)\r\nPJD = (XJN, PCV)\r\nFLJ = (VRH, NBF)\r\nRXS = (DNN, DHH)\r\nDQD = (NTV, CRQ)\r\nHGJ = (QJF, JTK)\r\nJDL = (QHC, TKN)\r\nVMX = (DVX, KDB)\r\nSPX = (FMD, MQS)\r\nDSQ = (BNF, PDJ)\r\nXJQ = (QST, MFT)\r\nBGX = (MSH, JQQ)\r\nCMT = (FSP, SCN)\r\nBVV = (LPL, LPL)\r\nMBR = (BHB, RMB)\r\nVVP = (QTP, TJC)\r\nBFC = (SMR, SMR)\r\nDTN = (CMN, NVG)\r\nBVN = (BKM, KPN)\r\nBCR = (MHM, MPT)\r\nNDK = (NHG, RVN)\r\nFRR = (NKL, KKN)\r\nXDP = (GBQ, VGF)\r\nKCS = (CXN, GGR)\r\nHLG = (FMQ, NXV)\r\nMTP = (KFV, QCH)\r\nVFH = (GPQ, RFK)\r\nHSG = (JKV, KNK)\r\nTHL = (CPG, BBF)\r\nFJP = (CVM, BVF)\r\nTGR = (LNL, JGD)\r\nJJD = (QLT, QMC)\r\nDQK = (NDK, NFS)\r\nKFN = (PJK, XSJ)\r\nQLN = (NKV, MGT)\r\nGJR = (HBJ, HLG)\r\nJXD = (NFK, KMD)\r\nCGM = (QHF, PJR)\r\nFPM = (DHB, VBS)\r\nNMK = (MVX, MFM)\r\nSJQ = (VBD, GKP)\r\nXVX = (KCS, TNV)\r\nFNC = (BCR, LQB)\r\nKLA = (XKM, DNG)\r\nCHD = (TPM, BHH)\r\nRMV = (PBC, QPM)\r\nBXH = (QDC, LKX)\r\nVQK = (HRJ, LBX)\r\nVNR = (SDB, JQL)\r\nTQS = (JPX, NLL)\r\nRPK = (KTX, XKP)\r\nAAA = (XMG, HJX)\r\nNQS = (TGB, RDK)\r\nJKK = (SFX, VDH)\r\nDKM = (RXJ, DXF)\r\nVGF = (MXT, LKT)\r\nKQN = (KTG, NCT)\r\nMXV = (HFT, QJM)\r\nCKP = (FMC, JPT)\r\nHGP = (JMV, DXV)\r\nVRC = (NVR, NHK)\r\nDPR = (VBV, FLJ)\r\nVBL = (PXB, BVN)\r\nGSG = (KSL, VSX)\r\nFNK = (VPD, NKN)\r\nLVB = (SQB, SQB)\r\nPRF = (HNP, TDG)\r\nTGV = (NVR, NHK)\r\nDXV = (QNK, PKL)\r\nKMP = (KVB, VMR)\r\nBTR = (LKF, PJD)\r\nQHC = (DFT, DTJ)\r\nRXM = (LRG, NPH)\r\nKTX = (RFR, QRT)\r\nJHR = (BRV, QRB)\r\nJDH = (BFX, DTN)\r\nJLQ = (TTV, GKH)\r\nCMQ = (HQL, PJP)\r\nDJF = (JTK, QJF)\r\nKVB = (MXL, PTK)\r\nDMD = (HXP, ZZZ)\r\nXJV = (CRV, JLM)\r\nJXR = (JMQ, LQM)\r\nDFT = (DRN, JQM)\r\nJSC = (XFX, XFX)\r\nCKB = (VVK, XBK)\r\nRFJ = (CKP, QMH)\r\nHRP = (LQT, CJV)\r\nHXJ = (CKB, FCT)\r\nDMX = (CRV, JLM)\r\nXBK = (LVB, FXN)\r\nJVP = (SKF, LCK)\r\nJLV = (VPT, DMK)\r\nSXK = (TNR, MTF)\r\nDTJ = (JQM, DRN)\r\nKLN = (FDX, NPN)\r\nSKG = (BTR, HXG)\r\nRFR = (XCT, FHN)\r\nFKB = (JJL, CGM)\r\nHNP = (DKR, JLQ)\r\nHKC = (FDM, XCS)\r\nQQN = (MTP, DCG)\r\nQRX = (RPJ, PQM)\r\nSMD = (BBD, DSQ)\r\nSFJ = (JMR, JMR)\r\nCJZ = (QMH, CKP)\r\nPGB = (SDJ, LQF)\r\nCMS = (XSG, TFG)\r\nJMV = (PKL, QNK)\r\nGHH = (RHT, RXS)\r\nNLN = (XJX, MVC)\r\nRCG = (DCG, MTP)\r\nXHF = (SSF, CBS)\r\nPNC = (GPB, MJJ)\r\nRXC = (XHF, LDN)\r\nXVM = (NKR, KQG)\r\nMTF = (FKN, FKV)\r\nFGM = (JPJ, DFG)\r\nMTG = (RRX, FFL)\r\nHCC = (RFS, PBH)\r\nTJL = (RPJ, PQM)\r\nRDK = (RLT, MMJ)\r\nCSD = (MDQ, HSG)\r\nKVP = (VRC, TGV)\r\nQJM = (LSF, DQK)\r\nTTV = (RCC, LXJ)\r\nTJC = (RDG, LFV)\r\nBFS = (FFL, RRX)\r\nBRV = (NRJ, HCN)\r\nHXP = (XMG, HJX)\r\nNJK = (MJT, GBX)\r\nDGV = (NDH, DPB)\r\nRGD = (KBH, XDP)\r\nCRV = (QBD, QLJ)\r\nRPS = (LPH, PRR)\r\nPLF = (BHH, TPM)\r\nSJF = (LFB, NMD)\r\nHLQ = (XJX, MVC)\r\nSJR = (XKM, DNG)\r\nTQP = (BTG, QJG)\r\nMTJ = (JPJ, DFG)\r\nSQB = (RFJ, RFJ)\r\nKPN = (VTC, LDH)\r\nBDZ = (CQP, HRP)\r\nQFC = (XJQ, PMR)\r\nXMV = (HTS, RXT)\r\nMQS = (FXV, VCL)\r\nTLQ = (XMV, TSC)\r\nTCQ = (CXH, RCV)\r\nKNK = (CBD, VQK)\r\nGHD = (DBJ, VPK)\r\nTKP = (TXK, MPJ)\r\nCCC = (NKL, KKN)\r\nQFN = (TJD, JDJ)\r\nDVJ = (GQM, QKJ)\r\nTNC = (PVV, PMJ)\r\nHJX = (DQD, JDR)\r\nNFF = (JMR, GTZ)\r\nJSB = (SLS, HSC)\r\nNVR = (CTV, PNS)\r\nFNV = (XLK, FNC)\r\nJVR = (TGB, RDK)\r\nTXM = (SNN, DMZ)\r\nCNF = (KLN, BDB)\r\nQRG = (PDS, MHP)\r\nQVV = (JJD, RLL)\r\nXML = (VMR, KVB)\r\nTLB = (NTD, VKD)\r\nSDJ = (CNQ, FNV)\r\nTKN = (DTJ, DFT)\r\nHFK = (LPF, XPH)\r\nLJP = (SFJ, SFJ)\r\nSMX = (RQV, DDH)\r\nJBL = (XML, KMP)\r\nNDA = (PBF, FHP)\r\nLRP = (XKP, KTX)\r\nJCK = (BGC, CNF)\r\nXCF = (SPJ, CVR)\r\nVNV = (CMQ, JPQ)\r\nBPJ = (XVP, DXQ)\r\nMVC = (QFC, DLV)\r\nQRK = (SDJ, LQF)\r\nBFX = (CMN, NVG)\r\nJMQ = (MFC, RXD)\r\nJPQ = (PJP, HQL)\r\nFCN = (NPH, LRG)\r\nRXQ = (FMG, GJF)\r\nDVX = (GSS, CFM)\r\nCSH = (VQF, PTV)\r\nSTM = (CFH, BMQ)\r\nNVF = (CSH, VHC)\r\nCKG = (VSX, KSL)\r\nBLG = (QHJ, DLB)\r\nRCB = (VVX, XCF)\r\nMGX = (HGT, HGP)\r\nNVG = (KMC, VSM)\r\nJLM = (QBD, QLJ)\r\nNKR = (HCD, RQC)\r\nQKJ = (VXK, TRR)\r\nXSJ = (TCQ, PCL)\r\nHQP = (HSJ, DGV)\r\nNPQ = (RBR, FNB)\r\nDDH = (PTQ, KQN)\r\nKTG = (DHL, KSX)\r\nMHP = (FCX, VCB)\r\nLBA = (CKP, QMH)\r\nGBX = (DLC, JRX)\r\nTKX = (RNJ, PPC)\r\nFHK = (KCV, NBK)\r\nCJV = (RCG, QQN)\r\nPPC = (JDH, SBM)\r\nKKN = (KVP, HBC)\r\nHBT = (XDM, PGN)\r\nCNC = (FVV, TCX)\r\nMXL = (BMP, BPJ)\r\nXVP = (TRL, HVN)\r\nXLX = (JSK, KNX)\r\nFCT = (VVK, XBK)\r\nCFH = (VRX, XMK)\r\nTNV = (CXN, GGR)\r\nJHK = (VQR, LDL)\r\nJPJ = (JBL, NBC)\r\nTNR = (FKV, FKN)\r\nRXJ = (SKG, BFK)\r\nQDV = (RHT, RXS)\r\nQQQ = (XHH, JVP)\r\nHGS = (MFV, DKC)\r\nNBK = (LNV, QLN)\r\nLDL = (CRJ, PRF)\r\nJRL = (KJS, PVK)\r\nFXR = (HCS, CMT)\r\nNVX = (GJR, GTQ)\r\nCFM = (SMT, SXK)\r\nTFG = (SPN, TLF)\r\nPPF = (KJN, NXJ)\r\nVPV = (HQP, KRB)\r\nMGT = (TJL, QRX)\r\nLGB = (KBH, XDP)\r\nBNS = (CTP, CBL)\r\nKSX = (BFS, MTG)\r\nGDD = (NBP, STP)\r\nCJQ = (VHM, JNQ)\r\nGQC = (NTD, VKD)\r\nFMC = (SKX, LRF)\r\nPTQ = (KTG, NCT)\r\nKNG = (BRV, QRB)\r\nKQG = (RQC, HCD)\r\nNSG = (HXJ, LBP)\r\nQPM = (KPK, XVX)\r\nCXH = (LGS, LQR)\r\nLCF = (GBS, MHB)\r\nVBD = (MBR, NBJ)\r\nSDB = (SVM, JJM)\r\nDCR = (FVK, KGG)\r\nBDJ = (XRG, CQL)\r\nJMR = (VRM, NFN)\r\nXFR = (LQM, JMQ)\r\nMBP = (CBL, CTP)\r\nGVD = (CLB, FMF)\r\nMFH = (PPC, RNJ)\r\nPTK = (BMP, BPJ)\r\nLGJ = (PXP, HJK)\r\nGKP = (MBR, NBJ)\r\nHXG = (LKF, PJD)\r\nNBC = (XML, KMP)\r\nSJG = (LPF, XPH)\r\nBKM = (VTC, LDH)\r\nDKC = (NQS, JVR)\r\nJSJ = (TQP, RLR)\r\nPMR = (QST, MFT)\r\nBRM = (PRR, LPH)\r\nKRL = (BGX, XNX)\r\nTCX = (GQC, TLB)\r\nQLJ = (FPS, JFN)\r\nHCD = (FXR, PJJ)\r\nTBN = (DSJ, VPV)\r\nFFL = (NBB, FKB)\r\nGRN = (HCC, NJF)\r\nLQB = (MHM, MPT)\r\nSFX = (LGB, RGD)\r\nHJB = (VNR, KFT)\r\nHRJ = (GLC, CHR)\r\nMJT = (DLC, JRX)\r\nFHN = (HHG, RMV)\r\nVTJ = (BFC, JTL)\r\nCQP = (CJV, LQT)\r\nVCB = (NGR, JRL)\r\nVNN = (JKK, SCK)\r\nXNT = (RXQ, LJS)\r\nSCN = (TNC, LGP)\r\nFMF = (TKP, NNT)\r\nVSM = (HNF, RLF)\r\nCNQ = (FNC, XLK)\r\nMPT = (TLQ, SBG)\r\nDSJ = (KRB, HQP)\r\nCXV = (QRK, PGB)\r\nLBX = (GLC, CHR)\r\nVBV = (NBF, VRH)\r\nTJQ = (LCH, HTJ)\r\nCPG = (QVC, CJQ)\r\nKJN = (PLB, DGH)\r\nNCM = (VTJ, SXJ)\r\nFXV = (NCM, SDH)\r\nXRG = (DPR, MXD)\r\nLCM = (PMN, VCS)\r\nSHN = (SMK, PHG)\r\nMXD = (FLJ, VBV)\r\nFDJ = (LKV, BKX)\r\nJDR = (NTV, CRQ)\r\nXDR = (LPV, XTH)\r\nRNJ = (JDH, SBM)\r\nFHP = (MGQ, HJB)\r\nPVH = (GPQ, GPQ)\r\nMGM = (RBS, HPR)\r\nVFQ = (RBR, FNB)\r\nXRV = (LCH, HTJ)\r\nDGP = (FDJ, GTJ)\r\nHJV = (DHB, VBS)\r\nKPK = (TNV, KCS)\r\nCMX = (DBJ, VPK)\r\nBHH = (VRN, SMX)\r\nPJL = (NLS, SCL)\r\nSPJ = (RXM, FCN)\r\nNTV = (TSJ, BSR)\r\nFXN = (SQB, GLR)\r\nDTK = (VVP, TCD)\r\nDBJ = (MFH, TKX)\r\nDCJ = (BTP, GVD)\r\nNMD = (DJB, MGC)\r\nPBC = (XVX, KPK)\r\nFRS = (KMD, NFK)\r\nLNL = (SQC, DTK)\r\nNGH = (XKL, HPT)\r\nRFS = (CHD, PLF)\r\nDMK = (JJT, FHK)\r\nSNS = (SHN, BMD)\r\nRLR = (BTG, QJG)\r\nFDM = (GRN, CBK)\r\nPLB = (CCT, JTT)\r\nVTC = (CMS, XSC)\r\nXKM = (QGF, TBN)\r\nMVJ = (SLB, TXM)\r\nPKL = (CSQ, SJQ)\r\nSLB = (SNN, SNN)\r\nJKV = (VQK, CBD)\r\nBBD = (BNF, PDJ)\r\nGSS = (SXK, SMT)\r\nLRG = (SPB, TGR)\r\nFDN = (JXD, FRS)\r\nXKX = (HXC, PGT)\r\nPDJ = (FRR, CCC)\r\nHXM = (VNN, VJG)\r\nQMC = (CXV, TLH)\r\nGLG = (GGV, VBL)\r\nRXT = (LCF, GBT)\r\nTGL = (NXJ, KJN)\r\nJPT = (SKX, LRF)\r\nNLL = (SPX, DDQ)\r\nBHB = (RGP, FQL)\r\nXKN = (HBT, XXG)\r\nRLT = (JLB, BDJ)\r\nSHF = (HGP, HGT)\r\nHKV = (DLB, QHJ)\r\nSVM = (XDR, BLN)\r\nPMN = (QTL, QRG)\r\nCXN = (JLV, FMT)\r\nGQV = (PJK, XSJ)\r\nHMM = (MGX, SHF)\r\nVSC = (PDH, XVM)\r\nLCK = (NSG, JPR)\r\nJQL = (JJM, SVM)\r\nFRQ = (SVG, DCR)\r\nTDG = (JLQ, DKR)\r\nSMT = (TNR, MTF)\r\nGBT = (GBS, MHB)\r\nQMH = (JPT, FMC)\r\nDXJ = (CMQ, JPQ)\r\nJJM = (XDR, BLN)\r\nDDQ = (FMD, MQS)\r\nNDH = (VVQ, DCM)\r\nLSF = (NFS, NDK)\r\nVGM = (STS, XNT)\r\nPJR = (GXF, JDL)\r\nXFC = (XVM, PDH)\r\nLBP = (CKB, FCT)\r\nKFT = (SDB, JQL)\r\nTTT = (QLS, GCV)\r\nLPH = (SJF, BPT)\r\nJGS = (XKL, HPT)\r\nVDH = (LGB, RGD)\r\nVHC = (VQF, PTV)\r\nNKN = (GDD, XDC)\r\nRND = (VGM, PSD)\r\nQVC = (VHM, JNQ)\r\nJJL = (QHF, PJR)\r\nQRB = (NRJ, HCN)\r\nMJJ = (FQT, RXC)\r\nNNA = (HRP, CQP)\r\nPBF = (MGQ, HJB)\r\nVRT = (DSS, FDN)\r\nDCM = (CLV, JCK)\r\nQLS = (SJR, SJR)\r\nRMT = (XHH, JVP)\r\nDMR = (MLF, MVJ)\r\nQJG = (NLN, HLQ)\r\nDLV = (XJQ, PMR)\r\nLKF = (XJN, PCV)\r\nVQR = (PRF, CRJ)\r\nSXJ = (BFC, JTL)\r\nMDQ = (KNK, JKV)\r\nQVD = (BVF, CVM)\r\nTGG = (LPL, BDZ)\r\nHDJ = (HGB, HSH)\r\nHTT = (LHQ, HGS)\r\nSKX = (HXM, JMF)\r\nFCX = (NGR, JRL)\r\nHSJ = (NDH, DPB)\r\nBFK = (HXG, BTR)\r\nXSG = (SPN, TLF)\r\nNCD = (MFM, MVX)\r\nPHG = (BKS, SMD)\r\nXMK = (QVD, FJP)\r\nFXL = (PGT, HXC)\r\nKBH = (VGF, GBQ)\r\nCBG = (QDC, LKX)\r\nLDN = (SSF, CBS)\r\nSVG = (FVK, KGG)\r\nBVF = (GHH, QDV)\r\nSPB = (LNL, JGD)\r\nLQR = (QXX, LCM)\r\nKHV = (JSK, KNX)\r\nLFV = (XFJ, XKN)\r\nQHG = (JJD, RLL)\r\nHGB = (LRP, RPK)\r\nNRJ = (DXJ, VNV)\r\nLKT = (PNC, LJX)\r\nMSH = (CDN, DMS)\r\nMLF = (SLB, SLB)\r\nMMJ = (JLB, BDJ)\r\nVRM = (HSR, HTT)\r\nMHM = (TLQ, SBG)\r\nLRF = (HXM, JMF)\r\nVHM = (PVH, VFH)\r\nFQL = (XRV, TJQ)\r\nMPJ = (LFS, CFJ)\r\nLMF = (CNC, KCC)\r\nJTK = (XJR, DGP)\r\nHFT = (DQK, LSF)\r\nRQV = (PTQ, KQN)\r\nLDT = (BMQ, CFH)\r\nRGP = (TJQ, XRV)\r\nSDH = (VTJ, SXJ)\r\nLKV = (JVB, TFD)\r\nKDD = (XFX, XGV)\r\nCVM = (GHH, QDV)\r\nPLS = (DVX, KDB)\r\nVCL = (NCM, SDH)\r\nSCK = (SFX, VDH)\r\nLJX = (MJJ, GPB)\r\nJTT = (LMF, SVS)\r\nPHV = (KRL, SVD)\r\nPDS = (VCB, FCX)\r\nVPD = (XDC, GDD)\r\nVRJ = (HXP, HXP)\r\nLPV = (HKC, XGS)\r\nBDB = (FDX, NPN)\r\nDXF = (BFK, SKG)\r\nFMG = (JGS, NGH)\r\nNXV = (LJP, SBT)\r\nPQM = (QVV, QHG)\r\nSNN = (PBF, FHP)\r\nLGP = (PMJ, PVV)\r\nFKV = (CBG, BXH)\r\nVJG = (JKK, SCK)\r\nJPR = (HXJ, LBP)\r\nTPM = (SMX, VRN)\r\nKXT = (VQR, LDL)\r\nNPN = (FRQ, SRD)\r\nTRL = (DCJ, BLS)\r\nCBK = (NJF, HCC)\r\nKMD = (GQV, KFN)\r\nGQM = (TRR, VXK)\r\nQST = (RMT, QQQ)\r\nXDM = (KXT, JHK)\r\nTLH = (QRK, PGB)\r\nVRH = (BNS, MBP)\r\nVVK = (LVB, LVB)\r\nHVN = (BLS, DCJ)\r\nTLJ = (HSG, MDQ)\r\nQLQ = (STM, LDT)\r\nLKX = (DBT, XTS)\r\nVXK = (DKM, KKV)\r\nXKL = (NPQ, VFQ)\r\nLDP = (BPH, RCB)\r\nVRN = (RQV, DDH)\r\nLJS = (FMG, GJF)\r\nFMT = (DMK, VPT)\r\nBPT = (LFB, NMD)\r\nRLL = (QMC, QLT)\r\nJNQ = (PVH, VFH)\r\nHJK = (JSC, KDD)\r\nQHF = (JDL, GXF)\r\nDGH = (JTT, CCT)\r\nPVV = (RND, XCQ)\r\nXFX = (VRJ, VRJ)\r\nNRN = (GQM, QKJ)\r\nVPK = (TKX, MFH)\r\nGLC = (PPF, TGL)\r\nJJT = (KCV, NBK)\r\nFVK = (XQS, PJL)\r\nVRD = (RCB, BPH)\r\nGPQ = (BVV, BVV)\r\nXCT = (HHG, RMV)\r\nVMR = (PTK, MXL)\r\nNTD = (XJV, DMX)\r\nCBS = (GHD, CMX)\r\nSNZ = (DNG, XKM)\r\nQTP = (LFV, RDG)\r\nDMZ = (FHP, PBF)\r\nLQT = (RCG, QQN)\r\nFPS = (RBX, DMR)\r\nLGS = (LCM, QXX)\r\nZZZ = (HJX, XMG)\r\nRCV = (LQR, LGS)\r\nPBH = (CHD, PLF)\r\nJPX = (DDQ, SPX)\r\nDNN = (MXV, DVB)\r\nQRT = (XCT, FHN)\r\nHHG = (PBC, QPM)\r\nSBM = (BFX, DTN)\r\nJVB = (VSC, XFC)\r\nQNK = (CSQ, SJQ)\r\nBPM = (KNG, JHR)\r\nHBC = (TGV, VRC)\r\nMGQ = (VNR, KFT)\r\nBTP = (CLB, FMF)\r\nSVD = (BGX, XNX)\r\nRHT = (DHH, DNN)\r\nKJS = (FRN, JSB)\r\nBLS = (GVD, BTP)\r\nTJD = (JXR, XFR)\r\nRMS = (HJV, FPM)\r\nMFV = (JVR, NQS)\r\nDXQ = (HVN, TRL)\r\nHSC = (BRM, RPS)\r\nCCP = (GGV, VBL)\r\nGTB = (QKQ, PHV)\r\nRBX = (MLF, MLF)\r\nMDN = (GBX, MJT)\r\nHXC = (KPF, DJL)\r\nHSR = (HGS, LHQ)\r\nBMD = (PHG, SMK)\r\nGTZ = (NFN, VRM)\r\nLDH = (CMS, XSC)\r\nNXJ = (PLB, DGH)\r\nFGR = (GJR, GTQ)\r\nKKV = (RXJ, DXF)\r\nXCQ = (PSD, VGM)\r\nJQQ = (DMS, CDN)\r\nXCS = (GRN, CBK)\r\nJQM = (FNK, DKQ)\r\nDNG = (QGF, TBN)\r\nGBQ = (MXT, LKT)\r\nQLT = (TLH, CXV)\r\nHTL = (NLL, JPX)\r\nDLB = (VRF, THL)\r\nGTQ = (HBJ, HLG)\r\nNBB = (CGM, JJL)\r\nGPB = (FQT, RXC)\r\nQBD = (FPS, JFN)\r\nNHG = (NRN, DVJ)\r\nTRR = (KKV, DKM)\r\nDJB = (XKX, FXL)\r\nCBD = (HRJ, LBX)\r\nCFJ = (BPM, RPN)\r\nTXK = (CFJ, LFS)\r\nTCD = (QTP, TJC)\r\nXTS = (GLG, CCP)\r\nPGN = (KXT, JHK)\r\nBMP = (XVP, DXQ)\r\nCQL = (MXD, DPR)\r\nHGT = (DXV, JMV)\r\nJDJ = (XFR, JXR)\r\nKRB = (HSJ, DGV)\r\nBSR = (VRT, GTK)\r\nRMB = (RGP, FQL)\r\nBKS = (BBD, DSQ)\r\nLQM = (RXD, MFC)\r\nRQC = (FXR, PJJ)\r\nTSC = (RXT, HTS)\r\nXPH = (HGJ, DJF)\r\nNPH = (TGR, SPB)\r\nSCL = (HDJ, PQL)\r\nXHH = (LCK, SKF)\r\nCBL = (MTJ, FGM)\r\nVQF = (QLQ, XLH)\r\nLPL = (HRP, CQP)\r\nVKD = (DMX, XJV)\r\nXJX = (DLV, QFC)\r\nKCC = (TCX, FVV)\r\nGJK = (RMS, RFL)\r\nJTL = (SMR, TTT)\r\nXMG = (JDR, DQD)\r\nPQL = (HSH, HGB)\r\nLCH = (GJK, DMM)\r\nPMJ = (RND, XCQ)\r\nFRN = (SLS, HSC)\r\nCHR = (PPF, TGL)\r\nDFG = (NBC, JBL)\r\nPJJ = (HCS, CMT)\r\nCRJ = (HNP, TDG)\r\nRLF = (JSJ, GMJ)\r\nGKH = (LXJ, RCC)\r\nRNT = (TJD, JDJ)\r\nCLV = (CNF, BGC)\r\nDRN = (FNK, DKQ)\r\nRDG = (XKN, XFJ)\r\nBNF = (CCC, FRR)\r\nHQH = (HPR, RBS)\r\nQJF = (DGP, XJR)\r\nNJF = (PBH, RFS)\r\nFKN = (CBG, BXH)\r\nFSP = (LGP, TNC)\r\nRXD = (SJG, HFK)\r\nPCL = (RCV, CXH)\r\nCLB = (NNT, TKP)\r\nXNX = (JQQ, MSH)\r\nVVQ = (JCK, CLV)\r\nDHH = (DVB, MXV)\r\nMXT = (LJX, PNC)\r\nMFC = (SJG, HFK)\r\nQKQ = (SVD, KRL)\r\nCVR = (FCN, RXM)\r\nRFK = (BVV, TGG)\r\nNBP = (HQH, MGM)\r\nQXX = (VCS, PMN)\r\nPVK = (FRN, JSB)\r\nHCN = (DXJ, VNV)\r\nXLK = (LQB, BCR)\r\nHPR = (HMM, CNT)\r\nVDF = (PHV, QKQ)\r\nKNX = (LGJ, CMC)\r\nPXB = (KPN, BKM)\r\nHNF = (GMJ, JSJ)\r\nDKR = (GKH, TTV)\r\nNGR = (KJS, PVK)\r\nQDC = (XTS, DBT)\r\nLPF = (DJF, HGJ)\r\nLXJ = (FGR, NVX)\r\nNBJ = (RMB, BHB)\r\nQGF = (DSJ, VPV)\r\nKSL = (QFN, RNT)\r\nDHL = (BFS, MTG)\r\nSTP = (MGM, HQH)\r\nFMQ = (LJP, LJP)\r\nTGB = (RLT, MMJ)\r\nTLF = (NCD, NMK)\r\nNLS = (PQL, HDJ)\r\nHRG = (SHN, BMD)\r\nDMM = (RMS, RFL)\r\nVPT = (JJT, FHK)\r\nSKF = (JPR, NSG)\r\nNFN = (HTT, HSR)\r\nKGG = (PJL, XQS)\r\nDHB = (CSD, TLJ)\r\nQVA = (VRM, NFN)\r\nSSF = (GHD, CMX)\r\nLFB = (DJB, MGC)\r\nGMJ = (TQP, RLR)\r\nHTS = (GBT, LCF)\r\nFQT = (LDN, XHF)\r\nTFD = (VSC, XFC)\r\nCMC = (PXP, HJK)\r\nVBS = (CSD, TLJ)\r\nDLC = (KHV, XLX)\r\nNKV = (TJL, QRX)\r\nKFV = (GSG, CKG)\r\nGGV = (BVN, PXB)\r\nDKQ = (NKN, VPD)\r\nSLS = (RPS, BRM)\r\nPJP = (VDF, GTB)\r\nBTG = (NLN, HLQ)\r\nVCS = (QTL, QRG)\r\nCSQ = (GKP, VBD)\r\nCCT = (LMF, SVS)\r\nNNT = (TXK, MPJ)\r\nXTH = (XGS, HKC)\r\nSMK = (BKS, SMD)\r\nHCS = (SCN, FSP)\r\nHPT = (NPQ, VFQ)\r\nKPF = (NVF, CDF)\r\nPDH = (KQG, NKR)\r\nPCV = (NJK, MDN)\r\nXXG = (PGN, XDM)\r\nMGC = (FXL, XKX)\r\nQTL = (PDS, MHP)\r\nJLB = (CQL, XRG)\r\nRVN = (DVJ, NRN)\r\nCTP = (FGM, MTJ)\r\nRCC = (FGR, NVX)\r\nCDF = (VHC, CSH)\r\nNKL = (HBC, KVP)\r\nPTV = (XLH, QLQ)\r\nBBF = (QVC, CJQ)\r\nTSJ = (VRT, GTK)\r\nGCV = (SJR, SNZ)\r\nNBF = (MBP, BNS)\r\nPSD = (XNT, STS)\r\nXLH = (LDT, STM)\r\nNFK = (GQV, KFN)\r\nVVX = (CVR, SPJ)\r\nPNS = (VMX, PLS)\r\nRBR = (HRG, SNS)\r\nSBT = (SFJ, NFF)\r\nDBT = (CCP, GLG)\r\nRPN = (KNG, JHR)\r\nXFJ = (HBT, XXG)\r\nJSK = (LGJ, CMC)\r\nCNT = (SHF, MGX)\r\nHBJ = (FMQ, NXV)\r\nVRX = (FJP, QVD)\r\nRBS = (CNT, HMM)\r\nSTS = (RXQ, LJS)\r\nDVB = (QJM, HFT)\r\nJRX = (XLX, KHV)\r\nRPJ = (QHG, QVV)\r\nKDB = (GSS, CFM)\r\nLHQ = (MFV, DKC)\r\nRRX = (FKB, NBB)\r\nHTJ = (GJK, DMM)\r\nCDN = (VRD, LDP)\r\nNFS = (RVN, NHG)\r\nXJR = (GTJ, FDJ)\r\nNCT = (DHL, KSX)\r\nNHK = (CTV, PNS)\r\nBGC = (KLN, BDB)\r\nXJN = (MDN, NJK)\r\nMFT = (RMT, QQQ)\r\nRFL = (HJV, FPM)\r\nXQS = (NLS, SCL)\r\nBPH = (XCF, VVX)\r\nSBG = (TSC, XMV)\r\nLNV = (MGT, NKV)\r\nQCH = (CKG, GSG)\r\nJMF = (VNN, VJG)\r\nLQF = (FNV, CNQ)\r\nMVX = (HKV, BLG)\r\nSQC = (VVP, TCD)\r\nPGT = (DJL, KPF)\r\nMFM = (BLG, HKV)\r\nFMD = (VCL, FXV)\r\nVRF = (BBF, CPG)\r\nGTJ = (LKV, BKX)\r\nXGV = (VRJ, DMD)\r\nCTV = (PLS, VMX)\r\nGLR = (RFJ, CJZ)\r\nPXP = (JSC, KDD)\r\nSRD = (SVG, DCR)\r\nGGR = (FMT, JLV)\r\nHSH = (RPK, LRP)\r\nGXF = (QHC, TKN)\r\nGBS = (TQS, HTL)\r\nMHB = (HTL, TQS)\r\nGTK = (DSS, FDN)\r\nDJL = (CDF, NVF)\r\nDPB = (VVQ, DCM)\r\nDCG = (KFV, QCH)\r\nFDX = (SRD, FRQ)\r\nXKP = (QRT, RFR)\r\nFVV = (GQC, TLB)\r\nDMS = (VRD, LDP)\r\nSVS = (KCC, CNC)\r\nPRR = (SJF, BPT)\r\nLFS = (RPN, BPM)\r\nBLN = (XTH, LPV)\r\nSPN = (NMK, NCD)\r\nCMN = (KMC, VSM)\r\nQHJ = (THL, VRF)\r\nJGD = (DTK, SQC)\r\nKCV = (QLN, LNV)\r\nCRQ = (TSJ, BSR)\r\nJFN = (RBX, DMR)\r\nGJF = (NGH, JGS)\r\nVSX = (RNT, QFN)\r\nHQL = (VDF, GTB)\r\nKMC = (HNF, RLF)\r\nXSC = (TFG, XSG)\r\nXDC = (STP, NBP)\r\nPJK = (TCQ, PCL)\r\nDSS = (JXD, FRS)\r\nSMR = (QLS, QLS)\r\nBMQ = (VRX, XMK)\r\nFNB = (SNS, HRG)\r\nBKX = (TFD, JVB)";
        private static List<string> _lines = Utilities.StringToLines(Input);
        private static Dictionary<string, string[]> _nodeDict = new Dictionary<string, string[]>();

        internal static long Part1()
        {
            var directions = _lines[0];
            SetupNodes();

            return CalculateSteps(directions);
        }

        internal static long Part2()
        {
            var directions = _lines[0];
            SetupNodes();

            return CalculatePart2(directions);
        }

        private static void SetupNodes()
        {
            for (int i = 2; i < _lines.Count; i++)
            {
                var split = _lines[i].Split('=').Select(s => s.Trim()).ToArray();
                var left = split[1].Substring(split[1].IndexOf('(') + 1, 3);
                var right = split[1].Substring(split[1].IndexOf(',') + 2, 3);

                _nodeDict.Add(key: split[0], value: new string[] { left, right });
            }
        }

        private static long CalculateSteps(string directions)
        {
            var steps = 0;
            var current = "AAA";
            var next = current;

            while (true)
            {
                foreach (var c in directions)
                {
                    // Get left or right node based on direction value
                    if (c == 'L') next = _nodeDict[current][0];
                    else next = _nodeDict[current][1];

                    current = next;
                    steps++;

                    if (next == "ZZZ") return steps;
                }
            }
        }

        private static long CalculatePart2(string directions)
        {
            var steps = 0;
            var currentKeys = _nodeDict.Keys.Where(k => k[2] == 'A').ToList();
            var zCycle = new long[currentKeys.Count];

            while (true)
            {
                foreach (var c in directions)
                {
                    int thisDir;
                    thisDir = c == 'L' ?  0 :  1;

                    // Next step for each of the places
                    for (int i = 0; i < currentKeys.Count; i++)
                    {
                        var thisKey = currentKeys[i];
                        currentKeys[i] = _nodeDict[thisKey][thisDir];

                        if (thisKey[2] == 'Z')
                        {
                            if (zCycle[i] == 0) zCycle[i] = steps;

                            // Exit if all Z cycles have been found and calculate LCM
                            if (zCycle.ToList().Count(x => x > 0) == zCycle.Length)
                                return Utilities.CalculateLcmMultiple(zCycle);
                        }
                    }
                    steps++;
                }
            }
        }
    }
}
