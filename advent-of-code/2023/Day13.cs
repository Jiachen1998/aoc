namespace aoc._2023
{
    internal static class Day13
    {
        private static readonly string TestInput = "#.##..##.\r\n..#.##.#.\r\n##......#\r\n##......#\r\n..#.##.#.\r\n..##..##.\r\n#.#.##.#.\r\n\r\n#...##..#\r\n#....#..#\r\n..##..###\r\n#####.##.\r\n#####.##.\r\n..##..###\r\n#....#..#";
        private static readonly string Input = "#..#...#.#..#\r\n#..#####.####\r\n#..######....\r\n.##...####.#.\r\n.##.##.#.####\r\n#..#.###.##.#\r\n.....###.#.#.\r\n.##..##..##..\r\n....#.#####..\r\n....###..##.#\r\n....####.##.#\r\n\r\n..#.#......#.\r\n###.#.####.#.\r\n##.##.#..#.##\r\n##..#.####.#.\r\n...###.##.###\r\n###.##.##.##.\r\n###..##..#...\r\n###..##..##..\r\n####.#.##.#.#\r\n\r\n.#.####.#.#\r\n...####....\r\n....##....#\r\n.#.####.#.#\r\n.#..##..#.#\r\n##......#.#\r\n.#..##..#.#\r\n####..####.\r\n.########..\r\n.#..##..#.#\r\n..######..#\r\n##.####.###\r\n##.####.###\r\n\r\n.##.##.\r\n#...##.\r\n.######\r\n#..#..#\r\n#..#..#\r\n.######\r\n#...##.\r\n.##.##.\r\n.#..#..\r\n.#.....\r\n##.....\r\n#.#####\r\n#..####\r\n##.#..#\r\n#.#####\r\n\r\n###....#####.\r\n.########.##.\r\n#.#.#..#.##..\r\n..######...#.\r\n#.##..##.##.#\r\n#...##...#.#.\r\n#..####..#.##\r\n.#.####.#.##.\r\n..........#..\r\n..........#..\r\n.#.####.#.##.\r\n\r\n#....###.\r\n......##.\r\n......#.#\r\n.#..#....\r\n..##....#\r\n########.\r\n#.##.#.#.\r\n######.##\r\n.#..#..#.\r\n..##.....\r\n..##.....\r\n.####.##.\r\n.####.###\r\n\r\n.....##\r\n####...\r\n....#..\r\n....#..\r\n####...\r\n.....##\r\n.##...#\r\n#..###.\r\n#..#.#.\r\n#.##.##\r\n.##.#.#\r\n\r\n...##...#.#..#..#\r\n...##...#.#..#..#\r\n#..####...###....\r\n...#.#.##.#...##.\r\n.###.#..##.###..#\r\n.####..##....####\r\n....##....##.####\r\n.#...#..#.#######\r\n..##..#....#.#..#\r\n##..#.#.#########\r\n#....#...#..##..#\r\n#..###.###..#.##.\r\n...#..#...####...\r\n\r\n###..##.......#\r\n###.###.......#\r\n#.#..#..###..#.\r\n.##.#..###..#.#\r\n.##.#..###..#.#\r\n#.#..#..###..#.\r\n###.###.......#\r\n###..##.......#\r\n.##.#####..#.##\r\n#...#.#.#..#..#\r\n..##.#.##.##...\r\n.###.##..####.#\r\n.###..##.#...#.\r\n.####.####.##..\r\n.##.#...#..####\r\n\r\n.###..#..###.\r\n...#....#....\r\n...#....#....\r\n.###..#..###.\r\n#.#..#..#...#\r\n##.###....##.\r\n.#.###.###..#\r\n...#####.###.\r\n##.#..####...\r\n..#.#.......#\r\n.###..#######\r\n#####.#.###..\r\n#####.#.###..\r\n.###..#######\r\n..#.#.......#\r\n#..#..####...\r\n...#####.###.\r\n\r\n.##.#..\r\n####.##\r\n.....##\r\n#####..\r\n####...\r\n.##.###\r\n#..##..\r\n#..#...\r\n####.##\r\n.##..##\r\n#..##..\r\n#..##..\r\n....###\r\n####...\r\n.##.#..\r\n#..#.##\r\n.#..#..\r\n\r\n######.\r\n.#..###\r\n..###.#\r\n####.##\r\n####.##\r\n..###.#\r\n.#..###\r\n######.\r\n.#####.\r\n.#.#..#\r\n..##...\r\n..#.###\r\n..#.###\r\n..#....\r\n.#.#..#\r\n\r\n.#..#.#.##..#\r\n#.####..#####\r\n..##.###.#..#\r\n.#.####.#.##.\r\n.#.####.#.##.\r\n..##.###.#..#\r\n#.####..#####\r\n.##.#.#.##..#\r\n#..#.###.####\r\n#..#.###..##.\r\n#..#..#.#....\r\n\r\n.#....#..\r\n.##.###..\r\n##.##.###\r\n##.##.###\r\n.#.##.#..\r\n.#....#..\r\n#.#..#.##\r\n##.##.###\r\n#......##\r\n###..####\r\n#..##..##\r\n\r\n#.#..#.#..#.#\r\n#.####.####.#\r\n.#....#.##.#.\r\n.#.##.#.##.#.\r\n.##..##....##\r\n##.##.######.\r\n..#..#......#\r\n#..###.#..#.#\r\n#..##..#..#..\r\n########..###\r\n.######....##\r\n\r\n..##....##...\r\n########.....\r\n#####..##....\r\n##..#..#.####\r\n#..#...###...\r\n####.#..##...\r\n....#.##.#...\r\n....#.##.#...\r\n######..##...\r\n#..#...###...\r\n##..#..#.####\r\n\r\n#.#.##.##\r\n..###.##.\r\n..###.##.\r\n#.#.##.##\r\n..#..##.#\r\n....####.\r\n#.###.#..\r\n.#.###.##\r\n.#.###.##\r\n#.#.#.#..\r\n....####.\r\n..#..##.#\r\n#.#.##.##\r\n\r\n#....#......#..\r\n......######...\r\n#.##.########.#\r\n##..##......##.\r\n.####........##\r\n.......#..#....\r\n#.##.##....#..#\r\n..##....##....#\r\n.####..#..#..##\r\n\r\n#.#....##..####\r\n.#..###........\r\n###...###..#..#\r\n###.#.###..#..#\r\n.#..###........\r\n#.#....##..####\r\n##.#.....#.####\r\n##.##.....##..#\r\n..##..#....#..#\r\n\r\n####......#..##.#\r\n...#.###.##.#####\r\n...#.###.##.#####\r\n####......#..##.#\r\n##.######...##.#.\r\n##.###..#.......#\r\n.#####...###..#..\r\n###.###..#.#..#..\r\n.#.#######.##...#\r\n.#.#######.##...#\r\n###.###..###..#..\r\n.#####...###..#..\r\n##.###..#.......#\r\n##.######...##.#.\r\n####......#..##.#\r\n\r\n###.##.##..##\r\n###.##.##..##\r\n.#..#...#.#..\r\n...####.###..\r\n#.#..##.##...\r\n#..#.#..#.###\r\n#...#.##....#\r\n\r\n....##...#.##\r\n.##.####.#..#\r\n#..###.....##\r\n####..##.#.##\r\n####.##..#...\r\n.##.##..####.\r\n#..##...##.##\r\n######.###..#\r\n.##.###...#..\r\n#..######...#\r\n#..######....\r\n\r\n...#.#..#..\r\n..#..##...#\r\n..#..##...#\r\n...#.#..#..\r\n##.#..#..##\r\n.######.#.#\r\n###.#..##..\r\n###.#..##.#\r\n.######.#.#\r\n\r\n##.##.##...#..##.\r\n#########..#...##\r\n.#.##.#.##.#...#.\r\n.#.##.#.##.#...#.\r\n#########.##...##\r\n##.##.##...#..##.\r\n##.##.#####.....#\r\n..####..#....#.#.\r\n#.####.#...###..#\r\n##....##.#......#\r\n##....###...####.\r\n##########.#.####\r\n#......#....#...#\r\n\r\n#....##..##..\r\n#....#....#..\r\n#.##.#.##.#.#\r\n.#..#.#.##.#.\r\n.#..#.#..#.#.\r\n......####...\r\n.......##....\r\n##..########.\r\n#.##.#.##.#.#\r\n######.##.###\r\n#....##..##..\r\n\r\n##..####.\r\n#.#......\r\n....#.##.\r\n##..####.\r\n####.##.#\r\n..#......\r\n##.#....#\r\n###.####.\r\n..#.#..#.\r\n..#......\r\n.#.#.##.#\r\n..#..##..\r\n..#..##..\r\n\r\n...#.#...#..##..#\r\n##.#.#.###......#\r\n##.###.###.#..#.#\r\n..#...#.#..#..#..\r\n.#.#.######.##.##\r\n..##..##.###..###\r\n####.##.#########\r\n...###..#..####..\r\n......###...##...\r\n...##..###..##..#\r\n...###.#...####..\r\n...###....#....#.\r\n..#......##....##\r\n.....##.####..###\r\n..#...#.....##...\r\n...#..#...#.##.#.\r\n####.....#......#\r\n\r\n###..###.##.#.##.\r\n...##...###.#..##\r\n........#..###..#\r\n.#....#.#######..\r\n###..####.##...##\r\n###..###..#..#.##\r\n...........###..#\r\n#########....#..#\r\n..#..#...####..#.\r\n##.##.####..#....\r\n............##.##\r\n########..##.#.#.\r\n.........#..##...\r\n##....####.....#.\r\n...##...#..#.###.\r\n\r\n###..#####.##\r\n##....####.#.\r\n...##...####.\r\n..####.......\r\n#......###.##\r\n########.###.\r\n..####....###\r\n.........##..\r\n...##....##..\r\n\r\n####...##..##..##\r\n....#...##..##.##\r\n.##.#.##......#..\r\n####.####..#...##\r\n.##.#.#.###.#....\r\n.##.#.#.###.#....\r\n####.####..#...##\r\n.##.#.##......#..\r\n....#...##..##.##\r\n####...##..##..##\r\n.....##..#.#....#\r\n..#..#####.##.##.\r\n.##.##....##..#.#\r\n#..##.##...#####.\r\n######..#.#......\r\n\r\n.###.###.##\r\n..#.#.##..#\r\n.##.....###\r\n.##.#...###\r\n..#.#.##..#\r\n.###.###.##\r\n#....###.#.\r\n#....###.#.\r\n.###.###.##\r\n\r\n...#.......#.####\r\n#..####..########\r\n..######..######.\r\n...#..#.......#.#\r\n#.######.#####.##\r\n...#..#...#...#..\r\n....##....##...##\r\n##..##..###..##..\r\n...#..#....#.#.#.\r\n....##....###.#..\r\n###.##.####.##.#.\r\n##.####.###....##\r\n##.####.###....##\r\n###.##.####.##.#.\r\n....##....###.#..\r\n\r\n#.##.##\r\n.#.####\r\n.#.....\r\n.#.....\r\n.#.####\r\n#.#####\r\n####.#.\r\n#..###.\r\n##..#..\r\n#####..\r\n######.\r\n..##...\r\n..##...\r\n\r\n...##....##....##\r\n.#..#.##.#..#.#.#\r\n...##....##...###\r\n#..##.##.##..####\r\n##.#.####.#.##...\r\n##.########.#####\r\n...#.####.#......\r\n##....##....##.##\r\n#.##.####.##.#...\r\n#.#...##...#.##..\r\n....##..##.......\r\n..#.######.#.....\r\n.#...####...#....\r\n\r\n#.##.###..#..\r\n#.##.###..#..\r\n#..#####..##.\r\n##..#.##.#.#.\r\n..###.....###\r\n####.######.#\r\n#.#.##......#\r\n#.#.##......#\r\n####.######.#\r\n...##.....###\r\n##..#.##.#.#.\r\n#..#####..##.\r\n#.##.###..#..\r\n\r\n#......##.###.#\r\n########...####\r\n#......##.#.##.\r\n...##....#.....\r\n#.####.#.###...\r\n#..##..##..#.#.\r\n.#....#.##.#..#\r\n..#..#..#.....#\r\n#..##..###...#.\r\n#..##..###..##.\r\n..#..#..#.....#\r\n.#....#.##.#..#\r\n#..##..##..#.#.\r\n#.####.#.###...\r\n...##....#.....\r\n\r\n##.#.###.##....#.\r\n###...#...#...#..\r\n###...#...#...#..\r\n##.#.###.##....#.\r\n#..#.#..###.###..\r\n###.####.#...#...\r\n...#.#.##.##.####\r\n##..####.####.###\r\n###.###.##..###.#\r\n..#..#.#...#.#..#\r\n...###.#.....#...\r\n..#.######.#..#.#\r\n..###.#.....##.##\r\n##.#.#..#.##..###\r\n...#.#.#.#.###.#.\r\n.......##..####..\r\n##....###..##..#.\r\n\r\n##.##.....#.###\r\n.#.##.###..#...\r\n.#.##.###..#...\r\n##.##.....#.###\r\n#....#...###...\r\n..#..#.#..#....\r\n.#.##.##...#.##\r\n..######.#.#...\r\n..###...###.###\r\n##....#..######\r\n.#..##.###.####\r\n##..##..##.#...\r\n.##..#.###..#.#\r\n\r\n.#.#.###.\r\n#.#.####.\r\n.....###.\r\n......##.\r\n#.#.####.\r\n.#.#.###.\r\n#...#...#\r\n.....#.#.\r\n.#..#.##.\r\n##..#....\r\n##..#....\r\n\r\n#......\r\n..####.\r\n.##..##\r\n#.##.#.\r\n#.####.\r\n##.##.#\r\n##.##.#\r\n\r\n#...###.#..#.\r\n..###...####.\r\n###.#..######\r\n.##.#..######\r\n..###...####.\r\n#...###.#..#.\r\n#.##.....##..\r\n\r\n.#..####..####..#\r\n.#..####..####..#\r\n.#..####..#####.#\r\n.#######..#######\r\n#####.######.####\r\n.....##....##....\r\n#..###.####.###..\r\n..##..........##.\r\n..######..######.\r\n\r\n#..##..####\r\n.....##.#.#\r\n.....##.#.#\r\n#..###.####\r\n####.#.#...\r\n.##.##....#\r\n#..##....##\r\n####...#...\r\n#####..#.##\r\n########..#\r\n#..#.#.#.##\r\n######.#.##\r\n#..#.##.#..\r\n......##.##\r\n#..##.##..#\r\n#..#...#.##\r\n########...\r\n\r\n.##.#.#####.#..##\r\n..###.#.#...###.#\r\n.##...#.#....#.#.\r\n..##.#..##....##.\r\n#..##...#...#.##.\r\n#..##...#...#.##.\r\n..##.#..##....##.\r\n.##...#.#....#.#.\r\n..###.#.#...###.#\r\n.##.#.#####.#..##\r\n###......#.##....\r\n###......#.##....\r\n.##.#..####.#..##\r\n\r\n....###..\r\n..#######\r\n#..######\r\n##...##..\r\n.##.####.\r\n###......\r\n###......\r\n.##.####.\r\n##...##..\r\n#..######\r\n..#######\r\n\r\n#.##.###.##.###\r\n.#.##..........\r\n.####...#..#...\r\n.#.#.###....###\r\n..#..###....###\r\n#######.####.##\r\n.#..#...####...\r\n......##....##.\r\n#.###...#..#...\r\n.###.....##....\r\n...#.##.####.##\r\n\r\n#...##..##...##\r\n#.###.##.###.##\r\n#.###.##.###.##\r\n#...##..##...##\r\n.#####..#####.#\r\n#...#.##.#...##\r\n..#.######.#..#\r\n..##......##...\r\n##..........##.\r\n.....####.....#\r\n##..##..##..##.\r\n#....####....##\r\n####.####.##.#.\r\n.####....####..\r\n.##.######.##..\r\n.....####.....#\r\n#.####..####.##\r\n\r\n..#.######.##\r\n..#.###.##.##\r\n##.#.#...#..#\r\n..####.#.##..\r\n...##..###...\r\n.....#....###\r\n##.###...#..#\r\n\r\n#..##.####.\r\n#..##.####.\r\n........#..\r\n...###.###.\r\n.###..#...#\r\n##.#####.#.\r\n#.##.#.#...\r\n#.##.#.....\r\n##.#####.#.\r\n.###..#...#\r\n...###.###.\r\n\r\n#..#.#.#.#..#.#\r\n......####..###\r\n#..###...#..#..\r\n.##.......##...\r\n.##.##.#####.##\r\n####.##...##...\r\n.....#..##..##.\r\n....##..##..##.\r\n......####..###\r\n#####.#..####..\r\n.....#.###..###\r\n####.#.##....##\r\n#..#.....####..\r\n\r\n...#....#....##\r\n#..........#...\r\n...######...#..\r\n.#.##..##.#.###\r\n##.#....#.##.##\r\n..#.####.#...##\r\n.....##........\r\n#.#.####.#.##..\r\n..##....##...##\r\n#..##..##..##..\r\n..#..##..#..#..\r\n#.#......#.#.##\r\n#.#......#.##..\r\n#.##....##.#...\r\n#..##..##..##..\r\n#..##..##..#...\r\n.#.##..##......\r\n\r\n.#..#..\r\n#.#.###\r\n#.#.#.#\r\n.##.##.\r\n.#..##.\r\n....#.#\r\n#.##.##\r\n....###\r\n..#.###\r\n..#.###\r\n....###\r\n#.##.##\r\n....#.#\r\n.#..##.\r\n.##.##.\r\n\r\n....####....###\r\n.....##......##\r\n#..######..#.#.\r\n.###.##.###...#\r\n...##..##......\r\n###.####.###.##\r\n###.####.###.#.\r\n\r\n####.######.####.\r\n####.######.####.\r\n###.#..##..#.###.\r\n#.....#..#.....#.\r\n.#..#..##..#..#..\r\n.##########.###.#\r\n#....#.##.#....#.\r\n\r\n.#...##..\r\n##.......\r\n###.##.#.\r\n.##......\r\n..###..##\r\n#.#######\r\n..###..##\r\n..#.#..#.\r\n..##.##.#\r\n..##.##.#\r\n..##.##.#\r\n\r\n.#.....\r\n#.##.##\r\n##..###\r\n..##...\r\n.#..#..\r\n#.##.##\r\n##..###\r\n#....##\r\n.#..#..\r\n#....##\r\n#.##.##\r\n\r\n.#..##..#.#..\r\n##########.##\r\n###....###...\r\n...#..#...##.\r\n..#....#...#.\r\n##.####.#####\r\n..######.....\r\n####..#####..\r\n##.####.##.#.\r\n###.##.######\r\n..#.##.#..###\r\n\r\n.#.#....#\r\n.#.#....#\r\n.#..####.\r\n###.#..#.\r\n.#.#.##.#\r\n#....##..\r\n#.##.##.#\r\n##.#....#\r\n#.#.#..#.\r\n...#....#\r\n..###..##\r\n##...##..\r\n####.##.#\r\n..#..##..\r\n..#.####.\r\n##.##..##\r\n.###..#.#\r\n\r\n#.##..#.######.\r\n#.#.####.####.#\r\n#..##.###.##.##\r\n.##.###########\r\n.#..#..#######.\r\n...##..#......#\r\n##..###.######.\r\n#..#..#########\r\n#...####..##..#\r\n##.####.######.\r\n##.####.######.\r\n#...####..##..#\r\n#..#..#########\r\n\r\n#.##...#..#\r\n#...##.####\r\n.####.#.##.\r\n##.###..##.\r\n.....#.....\r\n#...#...##.\r\n.#.#.#..##.\r\n.#...#..##.\r\n#...#...##.\r\n\r\n#....#.##...##.##\r\n#.##.##.###.##...\r\n#######.###.##...\r\n#....#.##...##.##\r\n##..##.###....#..\r\n#.##.#...######..\r\n...............##\r\n#....##.#.#.##.##\r\n#....##.#...#...#\r\n.####..#.#.#.....\r\n.#..#............\r\n\r\n..#....#..###\r\n...#..#......\r\n...#..#.....#\r\n##.####.#####\r\n.###..###....\r\n...#..#......\r\n.##.##.##.#..\r\n...####....##\r\n##.####.###..\r\n.#.####.#....\r\n.#......#....\r\n...#..#......\r\n#.######.####\r\n\r\n#....##.#..##.###\r\n..##...#..##.##.#\r\n..##..###.##..###\r\n.......#.#......#\r\n..##..#.....##...\r\n.####..#..#....##\r\n.#..#..#.#..#####\r\n#.##.#.....###.##\r\n..##...#...#.#.##\r\n##..#####.#..#.#.\r\n..##..#..#.##.#.#\r\n..##..#####..####\r\n..##..#####..####\r\n..##..#..#.##.#.#\r\n##..#####.##.#.#.\r\n\r\n#.#..#.##\r\n###..##..\r\n##....###\r\n...##...#\r\n...##...#\r\n##....###\r\n###..##..\r\n#.#..#.#.\r\n#.#..#.#.\r\n###..##..\r\n##....###\r\n\r\n..####.##.#\r\n#.#.###..##\r\n#..#..####.\r\n......####.\r\n##.##.#..#.\r\n##....####.\r\n..##.......\r\n.######..##\r\n.#.#.##..##\r\n.#.#.##..##\r\n.######..##\r\n..##.......\r\n##....####.\r\n##.##.#..#.\r\n...#..####.\r\n\r\n..##....##....#\r\n#..#....##....#\r\n#..............\r\n####.##.##.##.#\r\n#.#############\r\n###.#..#..#..#.\r\n..##.##.##.##.#\r\n##..#........#.\r\n.##############\r\n.#.............\r\n.#...##....##..\r\n##..####..####.\r\n..#.####..####.\r\n..#..##....##..\r\n#...#..#..#..#.\r\n#..............\r\n###............\r\n\r\n...###..#..\r\n.######...#\r\n#.#.#.....#\r\n.#.#....#.#\r\n.#.#....#.#\r\n#.#.#.....#\r\n.######...#\r\n...###..#..\r\n.#.###.####\r\n...#...##.#\r\n.....#...##\r\n.####..###.\r\n.####..#.#.\r\n\r\n..##..##.\r\n####..###\r\n..#.##.#.\r\n...#..#..\r\n..######.\r\n..#.##.#.\r\n###....##\r\n..##...#.\r\n###....##\r\n\r\n##.##.####.##\r\n##.....###...\r\n.##.##.#.....\r\n##....#.#.#..\r\n#.....#.#.#..\r\n.##.##.#.....\r\n##.....###...\r\n##.##.####.##\r\n..#..##...#..\r\n.###.##..##..\r\n...##.#..##..\r\n.##..##....##\r\n##.#..####...\r\n\r\n#....##...##.\r\n..###.##.#..#\r\n.#.###.......\r\n.#.###.......\r\n..###.##.#..#\r\n#....##...##.\r\n#..####...##.\r\n..##..####..#\r\n..####.#.....\r\n##...#.#.#..#\r\n#.#..#.......\r\n...##.#..#..#\r\n..######.####\r\n##..#.#######\r\n###...#.##...\r\n..###..#.####\r\n##.#.####.##.\r\n\r\n.###.##.#\r\n.####.#..\r\n.#...####\r\n#..#.####\r\n....###.#\r\n..#.#.#.#\r\n####.###.\r\n...###.#.\r\n.####.#.#\r\n.#...###.\r\n.#...####\r\n.#...####\r\n.#...###.\r\n\r\n.#..#..#..#\r\n.##########\r\n##..####..#\r\n#..........\r\n.####..####\r\n###.#..#.##\r\n##..#..#..#\r\n#.##.##.##.\r\n..##....##.\r\n\r\n##.######.##..#.#\r\n##.######.##..#.#\r\n#.###..###.#...#.\r\n###.#..#.###.#...\r\n.#.#....#.#....#.\r\n...#....#...###.#\r\n.####..####..##.#\r\n..##.##.##..#####\r\n.#........#.##...\r\n#..######..#.#.#.\r\n...#.##.#....#.##\r\n#....##....##....\r\n.###....###.##..#\r\n.#.######.#....##\r\n####....####.....\r\n#...#..##..###.#.\r\n#...#..#...###...\r\n\r\n....#.###....##\r\n.##.#....#..#..\r\n.#.##....####..\r\n#..######....##\r\n....###........\r\n#####.#..####..\r\n.#..###..####..\r\n....###########\r\n.....####....##\r\n##.####..####..\r\n#.##.###.#..#.#\r\n.#..#####....##\r\n#.#.#.#..####..\r\n\r\n##...#.#.#.##\r\n.......#.###.\r\n###.#..###...\r\n##..#...#....\r\n..#.#...##...\r\n#####.#....##\r\n#####.#....##\r\n..#.#...##...\r\n##......#....\r\n###.#..###...\r\n.......#.###.\r\n##...#.#.#.##\r\n....##.#..###\r\n\r\n..##...\r\n.#.####\r\n..###..\r\n#.#..##\r\n...#...\r\n#...###\r\n#......\r\n#..####\r\n.####..\r\n#..####\r\n..##.##\r\n....#..\r\n..#.#..\r\n\r\n#.###......###.\r\n.#.##..##..##.#\r\n.#.##..##..##.#\r\n#.###......###.\r\n#..####..####..\r\n......####.....\r\n######.##..####\r\n...#...##...#..\r\n....###..###...\r\n\r\n#..##.#....##.###\r\n.#.#......#.##...\r\n#...#...#...#..##\r\n#..##..#.#..##...\r\n#########.##.##.#\r\n#########.##.##.#\r\n#..##..#.#..##...\r\n#...#...#...#..##\r\n.#.#......#.##...\r\n#..##.#..#.##.###\r\n#..#.##.#...#.###\r\n.#......#..###..#\r\n.##.##.##...##...\r\n.######..####..##\r\n####.#..#..#.#...\r\n####.#..#..#.#...\r\n.######..####..##\r\n\r\n...###.\r\n...###.\r\n.#...#.\r\n..#.###\r\n.#...#.\r\n....#.#\r\n.#.###.\r\n.#.###.\r\n....#.#\r\n.#...#.\r\n..#.###\r\n##...#.\r\n...###.\r\n\r\n##..###..##..##\r\n##..#####......\r\n#.##.#..#.####.\r\n######.##..##..\r\n#.##.##########\r\n#######..##..##\r\n#####..#.......\r\n.####..#...##..\r\n##..######.##.#\r\n\r\n.##.######.##..##\r\n.#####..#####..##\r\n##..##..##..####.\r\n#.#.#....###.##.#\r\n.#...#..#...#..#.\r\n##.###..###.####.\r\n.#..........#..#.\r\n...##.##.##......\r\n##...#..#...####.\r\n......##.........\r\n##..#.##.#..####.\r\n\r\n###..##\r\n####..#\r\n####..#\r\n..#..##\r\n##.#.##\r\n##...##\r\n...####\r\n#####..\r\n..#...#\r\n..#####\r\n###...#\r\n..#..#.\r\n##..#.#\r\n##.....\r\n###..##\r\n..###.#\r\n...##.#\r\n\r\n.#....###.#.#\r\n###.##.#.....\r\n###.##.#...#.\r\n.#....###.#.#\r\n#######..#...\r\n#######..#...\r\n.#....###.#.#\r\n###.##.#...#.\r\n###.##.#.....\r\n.#....###.#.#\r\n..#..#.....#.\r\n#.......#.#.#\r\n#.#####.#.##.\r\n....#...#..##\r\n..#.##.#.####\r\n####.######.#\r\n..###.#.#...#\r\n\r\n..#.#.#\r\n#####..\r\n...###.\r\n...#..#\r\n##..##.\r\n###..#.\r\n##.###.\r\n......#\r\n#.###.#\r\n####...\r\n..##..#\r\n##.....\r\n##.##.#\r\n##.####\r\n##.####\r\n\r\n####..###\r\n....##...\r\n..######.\r\n..##..##.\r\n##.####.#\r\n###.#..##\r\n##......#\r\n\r\n..#..####..\r\n..#.##..##.\r\n##.###..###\r\n##.###..###\r\n..#.##..##.\r\n..#..####..\r\n#...######.\r\n######..###\r\n...##....##\r\n#.#...##.#.\r\n#.##..##..#\r\n#...##..##.\r\n.##..#..#..\r\n\r\n#.#####\r\n.#.#..#\r\n.#.#..#\r\n#..####\r\n#....##\r\n#....##\r\n#..####\r\n.#.#..#\r\n.#.#..#\r\n#.#####\r\n##.##.#\r\n..##.##\r\n#..#.##\r\n#...#.#\r\n#.####.\r\n##.#...\r\n.#.####\r\n\r\n##.#..###....#..#\r\n#.###.##.#.##..##\r\n...##.#.#.##..#..\r\n#.#..####..##....\r\n#.#..####..##....\r\n...##.#.#.##.##..\r\n#.###.##.#.##..##\r\n##.#..###....#..#\r\n....#.#....#.##.#\r\n#.###...###.###.#\r\n##.##..#########.\r\n#.#....##.#..#.#.\r\n.##.#...###....#.\r\n.#.###...#..#..#.\r\n.#.###...#..#..#.\r\n.##.#...###....#.\r\n#.#....##.#..#.#.\r\n\r\n#.#.##.\r\n#...#..\r\n..#..#.\r\n##..#..\r\n##..#..\r\n..#..#.\r\n#...#..\r\n#.#.##.\r\n##..###\r\n.####..\r\n.#.#...\r\n###.##.\r\n##..#..\r\n##..#..\r\n###.#..\r\n.#.#...\r\n.####..\r\n\r\n###.#..#.##\r\n..##.#.....\r\n...#.###...\r\n...#.#...##\r\n....####...\r\n......#.#..\r\n...###.#.#.\r\n\r\n#.##.##.#\r\n..##..###\r\n.#.....#.\r\n##..##.##\r\n......##.\r\n#.##.#..#\r\n######.#.\r\n..##....#\r\n##..###.#\r\n#.##.####\r\n#.##.####\r\n##..###.#\r\n..##....#\r\n######.#.\r\n#.##.#..#\r\n......##.\r\n##..##.##\r\n\r\n####.##.######.#.\r\n...######....#.#.\r\n..###..###..#.##.\r\n..###..###..#.##.\r\n...######....#.#.\r\n####.##.######.#.\r\n#....##....#.....\r\n...#.##.#...##.#.\r\n..#..##..#..####.\r\n#.##....##.#.#.#.\r\n###############..\r\n.........#..#.#..\r\n############..#.#\r\n\r\n.##.#....#.\r\n..#.#....#.\r\n###..#..#..\r\n#...##..##.\r\n..###....##\r\n..#..####..\r\n####.#..#.#\r\n\r\n##.##......\r\n##..#.#..#.\r\n..#..#.##.#\r\n###.##.#..#\r\n....#.#..#.\r\n####.......\r\n..#...####.\r\n\r\n###.##.#####.\r\n####...######\r\n..#.##..####.\r\n##..#.#.#..#.\r\n###.##.######\r\n..#..##.#..#.\r\n########.##.#\r\n..##.#.######\r\n..#......##..\r\n..#....##..##\r\n##.####......\r\n\r\n...#..#.......##.\r\n.##....##...#####\r\n#..#..#..#.......\r\n..##..##..#......\r\n.###..###..#..##.\r\n.##....##.#...##.\r\n############.####\r\n#.#.##.#.#.##....\r\n#.##...#.#....##.\r\n.##.##.##....#..#\r\n.###..###.##.....\r\n#...##...#####..#\r\n###....###.##.##.\r\n#.##..##.#..##..#\r\n##......##.......\r\n##########..#####\r\n#.##..##.#..#.##.\r\n\r\n.#.#.####\r\n...#.#.##\r\n..###....\r\n#..##.#.#\r\n##..##...\r\n.###..#..\r\n##.#.####\r\n##.#.#..#\r\n#.#####..\r\n#...#.#.#\r\n#...#.#..\r\n#...#.#..\r\n#...#.#.#\r\n\r\n##.#..###.#..\r\n...####.#.###\r\n..#....##.#..\r\n###..##.##...\r\n##.####.#..##\r\n####.#..#..##\r\n###.#..##.###\r\n......##.#.##\r\n###....#..#..\r\n...##.#######\r\n##.#...#.#.##\r\n..#.####.#.##\r\n###...#..####\r\n..#..#.####.#\r\n##.##.#...###\r\n..####...##..\r\n...#...#.####\r\n\r\n.....##.#..#.####\r\n.##....#####....#\r\n#..##.###.###.##.\r\n######.##.....##.\r\n.##.#..##..###..#\r\n####..#.###.#####\r\n####.#..#..#.#..#\r\n####.#.#..###....\r\n########..##..##.\r\n#######.#.##.....\r\n.....##..#..#....\r\n\r\n#...#..######.#.#\r\n...#.###.##..#.#.\r\n###....#..#..#.#.\r\n.##.######.###.#.\r\n##..#..#..###....\r\n##..#..#..###....\r\n.##.##########.#.\r\n###....#..#..#.#.\r\n...#.###.##..#.#.\r\n#...#..######.#.#\r\n.##.#.#..#....##.\r\n.##.#.#..#....##.\r\n#...#..######.#.#";
        private static List<string> _lines = Utilities.StringToLines(Input);

        internal static int Part1()
        {
            var sum = 0;
            var mirrors = new List<char[,]>();
            var thisMirror = new List<string>();
            foreach (var line in _lines)
            {
                if (line == "")
                {
                    // Convert mirror to 2D char grid and clear
                    mirrors.Add(Utilities.StringsToGrid(thisMirror));
                    thisMirror = new List<string>();
                    continue;
                }
                thisMirror.Add(line);
            }
            mirrors.Add(Utilities.StringsToGrid(thisMirror));

            foreach (var mirror in mirrors)
            {
                //Utilities.PrintGrid(mirror);
                //Console.WriteLine();
                //Utilities.PrintGrid(Utilities.TransposeGrid(mirror));
                //Console.WriteLine();

                // Calculate
                var leftCols = FindMirror(mirror);
                sum += leftCols;

                var topCols = FindMirror(Utilities.TransposeGrid(mirror));
                sum += topCols * 100;
            }
            return sum;
        }

        internal static int Part2()
        {
            // Go through 
            return 0;
        }

        /// <summary>
        /// Given a mirror, find the dividing line, check if it is mirrored, if so return number to the left. If not mirrored, return zero.
        /// </summary>
        /// <param name="mirror"></param>
        /// <returns></returns>
        internal static int FindMirror(char[,] mirror)
        {
            // Loop through columns
            for (int i = 0; i < mirror.GetLength(1) - 1; i++)
            {
                var thisCol = Utilities.GetCol(mirror, i);
                var nextCol = Utilities.GetCol(mirror, i + 1);

                if (Utilities.CompareArray(thisCol, nextCol))
                {
                    // We are in potential mirroring territory
                    var leftSide = Utilities.GetCols(mirror, 0, i);
                    var leftSideFlipped = Utilities.ReflectCols(leftSide);
                    var rightSide = Utilities.GetCols(mirror, i + 1, mirror.GetLength(1) - 1);
                    
                    var smallerCols = Math.Min(leftSide.GetLength(1), rightSide.GetLength(1));
                    for (int j = 0; j < smallerCols; j++)
                    {
                        var leftCol = Utilities.GetCol(leftSideFlipped, j);
                        var rightCol = Utilities.GetCol(rightSide, j);

                        // If no longer mirrored then break
                        if (!Utilities.CompareArray(leftCol, rightCol)) break;

                        // If we hit the end and is still mirrored, return left
                        if (j == smallerCols - 1)
                        {
                            return leftSide.GetLength(1);
                        }
                    }
                }
            }
            return 0;
        }
    }
}
